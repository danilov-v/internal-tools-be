# Работа с базой данных

База данных для проекта запускается в `docker`.
Для запуска необходимо в директории `database` выполнить команду `docker-compose up`.

Для хранения данных между перезапусками используется папка `db_data`.

## Создание базы

Изначально база создается при помощи скрипта `scripts/CreateDatabase.sql`.

Для большей информации можно просмотреть `docker-compose.yml`.

## Миграции

Изменения, [связанные со структурой базы данных](http://knexjs.org/#Migrations).

Для создания новой миграции выполните `npm run migrate:make <migration_name>`.
Это создаст шаблон для новой миграции в папке `migrations`.

Проверить статус миграций на вашей базе можно с помощью `npm run migrate:status`.

Для запуска всех миграций, которые еще не были применены используйте `npm run migrate:latest`.

## Сиды

Изменения [связанные с данными (наполнением) базы данных](http://knexjs.org/#Seeds).

Для создания нового сида выполните `npm run seed:make <seed_name>`.
Это создаст шаблон для нового сида в папке `seeds`.

**Перед использованием knex's Seed CLI прочитайте [документацию](http://knexjs.org/#Seeds-CLI)!**

Сиды должны запускаться по одному в нужном порядке (с использованием скриптов из `package.json`).
Например, `npm run seed:initial`.

## Дополнительная информация

Для данного проекта мы используем:

- [PostgreSQl 12](https://www.postgresql.org);
- [Objection.js](https://vincit.github.io/objection.js) в качестве ORM;
- [Knex](http://knexjs.org) для построения SQL запросов.
